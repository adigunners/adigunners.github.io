name: Guard public repo
on: [push, pull_request]
jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Scan for sensitive filenames
        run: |
          if git ls-files | grep -Eiq '(TECHNICAL_DOCUMENTATION|SCORING_|SYSTEM_GUIDE|DEVELOPER_GUIDE|EMAIL_CONTROL_PANEL|COLLABORATION_GUIDE|CI_CD|RELEASE_CHECKLIST|TESTING|TESTING_REFERENCE|EMAIL_PRIZE_REFERENCE)'; then
            echo "Found proprietary doc names in public repo"; exit 1; fi
      - name: Scan for sensitive content
        run: |
          if grep -RniE '(client_secret|service account|transfer hits|prize split|internal runbook|admin only)' -- .; then
            echo "Found sensitive keywords in public repo"; exit 1; fi